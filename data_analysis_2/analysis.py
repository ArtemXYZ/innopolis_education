import pandas as pd

# Загрузка данных
df = pd.read_excel('../data/dataset.xlsx')

# 1. Вывести первые 10 строк датасета
print("1. Первые 10 строк:")
print(df.head(10))

# 2. Вывести случайные 5 строк датасета
print("\n2. Случайные 5 строк:")
print(df.sample(5))

# 3. Вывести количество строк и столбцов
print("\n3. Размеры датасета:")
print(f"Строк: {len(df)}, Столбцов: {len(df.columns)}")

# 4. Вывести количество пропущенных значений
print("\n4. Пропущенные значения:")
print(df.isna().sum())

# 5. Удалить строки с пропусками и проверить
print("\n5. Очищенный датафрейм:")
clean_df = df.dropna()
print(f"Было: {len(df)} строк, стало: {len(clean_df)} строк")
print(clean_df.head())

# 6. Найти мин, макс и средний рейтинг
print("\n6. Статистика по рейтингу:")
print(f"Максимальный: {df['j'].max()}")
print(f"Минимальный: {df['j'].min()}")
print(f"Средний: {df['j'].mean():.2f}")

# 7. Приложения с рейтингом ≥4.9 (первые 10)
print("\n7. Топ-10  ≥10:")
print(df[df['j'] >= 10].head(10)[['v', 'j']])

# 8. 5 самых скачиваемых приложений
print("\n8. Топ-5 в с по q:")
print(df.nlargest(5, 'q')[['q', 'c']])